os: linux
dist: focal
language: node_js
node_js:
  - "stable"
cache:
  directories:
    - "node_modules"
branches:
  except:
  - version
  
before_install:
  - curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
  - sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
  - sudo apt-get update
  - sudo apt-get -y -o Dpkg::Options::="--force-confnew" install docker-ce  

script:
  - docker --version 
  - docker login --username=ajv21 -p=Jun21@2021
  - docker buildx create --name vigbuild
  - docker buildx use vigbuild
  - docker buildx inspect --bootstrap
  - docker buildx build -t ajv21/sample/:buildx_test --platform linux/arm64 --push .
  - docker buildx rm vigbuild 
